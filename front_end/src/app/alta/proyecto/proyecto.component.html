<mat-card>
  <mat-card-content class="center-text">

    <form [formGroup]="formProy" (ngSubmit)="addProyecto()">
      <mat-grid-list cols="4" rowHeight="10px">
        <mat-grid-tile rowspan="6"></mat-grid-tile>

        <mat-grid-tile rowspan="6">
          <mat-form-field class="full-width-field">
            <input type="text" matInput placeholder="Clave" formControlName="clave">
            <mat-error *ngIf="clave.invalid">{{getErrorMessage('clave')}}</mat-error>
          </mat-form-field>
        </mat-grid-tile>

        <mat-grid-tile rowspan="6">
          <mat-form-field class="full-width-field p-l-2">
            <input type="text" matInput placeholder="Cliente" formControlName="cliente">
            <mat-error *ngIf="cliente.invalid">{{getErrorMessage('cliente')}}</mat-error>
          </mat-form-field>
        </mat-grid-tile>

        <mat-grid-tile rowspan="6"></mat-grid-tile>
        <mat-grid-tile rowspan="6"></mat-grid-tile>
        <mat-grid-tile rowspan="6">
          <mat-form-field class="full-width-field ">
            <input type="number" matInput placeholder="Monto" formControlName="monto">
            <mat-error *ngIf="monto.invalid">{{getErrorMessage('monto')}}</mat-error>
            <span matPrefix>$&nbsp;</span>
          </mat-form-field>
        </mat-grid-tile>


        <mat-grid-tile rowspan="6">
          <mat-form-field class="full-width-field p-l-2">
            <input matInput placeholder="#OT" formControlName="ot">
            <mat-error *ngIf="monto.invalid">{{getErrorMessage('ot')}}</mat-error>
          </mat-form-field>
        </mat-grid-tile>
        <mat-grid-tile rowspan="6"></mat-grid-tile>
        <mat-grid-tile rowspan="6"></mat-grid-tile>

        <mat-grid-tile rowspan="6" colspan="2">
          <mat-form-field class="full-width-field">
            <mat-label>Tipo</mat-label>
            <mat-select formControlName="tipo" name="tipo" id="jj" class="form-control" required>
              <mat-option *ngFor="let tipo of tipos" [value]="tipo.id">
                {{tipo.text}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </mat-grid-tile>
        <mat-grid-tile rowspan="6"></mat-grid-tile>
        <mat-grid-tile rowspan="6" colspan="4">
          <p>
            <button mat-raised-button color="primary" type="submit">Agregar</button>
          </p>
        </mat-grid-tile>

      </mat-grid-list>
    </form>

  </mat-card-content>
</mat-card>

<mat-card>
  <mat-card-content>
    <div>
      <label>
        <h3>Proyectos</h3>
      </label>
    </div>
    <div class="center-text mat-elevation-z8">
      <table mat-table #table [dataSource]="allData" style="width: 100%;">
        <ng-container matColumnDef="clave">
          <mat-header-cell *matHeaderCellDef>Clave</mat-header-cell>
          <mat-cell *matCellDef="let proyecto">
            <div> {{proyecto.clave}} </div>
          </mat-cell>
        </ng-container>
        <ng-container matColumnDef="cliente">
          <mat-header-cell *matHeaderCellDef>Cliente</mat-header-cell>
          <mat-cell *matCellDef="let proyecto">
            <div> {{proyecto.cliente}} </div>
          </mat-cell>
        </ng-container>
        <ng-container matColumnDef="monto">
          <mat-header-cell *matHeaderCellDef>Monto</mat-header-cell>
          <mat-cell *matCellDef="let proyecto">
            <div>$&nbsp; {{proyecto.monto}} </div>
          </mat-cell>
        </ng-container>
        <ng-container matColumnDef="ot">
          <mat-header-cell *matHeaderCellDef>Ot</mat-header-cell>
          <mat-cell *matCellDef="let proyecto">
            <div> {{proyecto.ot}} </div>
          </mat-cell>
        </ng-container>
        <ng-container matColumnDef="tipo">
          <mat-header-cell *matHeaderCellDef>Tipo</mat-header-cell>
          <mat-cell *matCellDef="let proyecto">
            <div> {{getTipoText(proyecto.tipo)}} </div>
          </mat-cell>
        </ng-container>
        <ng-container matColumnDef="actions">
          <mat-header-cell *matHeaderCellDef>Actions </mat-header-cell>
          <mat-cell *matCellDef="let proyecto">
            <button mat-button color="primary" (click)="openDialog(this.proyecto)">Edit</button> |
            <button mat-button color="warn" (click)="delete(this.proyecto)">Delete</button>
          </mat-cell>
        </ng-container>
        <mat-header-row *matHeaderRowDef="columnsToDisplay"></mat-header-row>
        <mat-row *matRowDef="let dataSource; columns: columnsToDisplay;"></mat-row>

      </table>
      <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>
    </div>

  </mat-card-content>
</mat-card>

<ng-template #callAPIDialog>
  <h2 matDialogTitle>Editando Proveedor </h2>
  <mat-dialog-content>
    
   
      <mat-form-field appearance="fill" class="full-width-field">
        <mat-label>Clave:</mat-label>
        <input matInput [(ngModel)]="proyToShow.clave">
      </mat-form-field>
      
      <mat-form-field appearance="fill" class="full-width-field">
        <mat-label>Cliente:</mat-label>
        <input matInput [(ngModel)]="proyToShow.cliente">
      </mat-form-field>
      
      <mat-form-field appearance="fill" class="full-width-field">
        <mat-label>Monto:</mat-label>
        <input matInput [(ngModel)]="proyToShow.monto">
      </mat-form-field>
      
      <mat-form-field appearance="fill" class="full-width-field">
      <mat-label>#OT:</mat-label>
        <input matInput  [(ngModel)]="proyToShow.ot">
      </mat-form-field>
      
      <mat-form-field appearance="fill" class="full-width-field">
        <mat-label>Tipo:</mat-label>
        <mat-select  [(ngModel)]="proyToShow.tipo">
          <mat-option *ngFor="let tipo of tipos" [value]="tipo.id">
            {{tipo.text}}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="fill" class="full-width-field">
        <mat-label>Ultima modificaci√≥n:</mat-label>
        <input matInput value="{{proyToShow.updatedAt | date :'short'}}" disabled>
      </mat-form-field>
      
      <mat-form-field appearance="fill" class="full-width-field">
        <mat-label>Proveedor creado:</mat-label>
        <input matInput value="{{proyToShow.createdAt | date :'short'}}" disabled> 
      </mat-form-field>
      
  </mat-dialog-content>
  <mat-dialog-actions align="end">
      <button mat-button matDialogClose="no" (click)="afeterC('no')">No</button>
      <button mat-button matDialogClose="yes" (click)="afeterC('yes')">Yes</button>
  </mat-dialog-actions>
</ng-template>